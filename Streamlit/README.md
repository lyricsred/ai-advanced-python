# Анализ температурных данных и мониторинг текущей температуры

Streamlit приложение для анализа исторических температурных данных и мониторинга текущей температуры через OpenWeatherMap API.

## Описание

Приложение позволяет:
- Загружать и анализировать исторические данные о температуре
- Выявлять аномалии в температурных данных
- Сравнивать производительность последовательного и параллельного анализа
- Получать текущую температуру через OpenWeatherMap API
- Сравнивать синхронные и асинхронные методы запросов к API
- Визуализировать данные с помощью интерактивных графиков

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd Streamlit
```

2. Создайте виртуальное окружение (рекомендуется):
```bash
python3 -m venv venv
```

3. Активируйте виртуальное окружение:
   - **Linux/Mac:**
     ```bash
     source venv/bin/activate
     ```
   - **Windows:**
     ```bash
     venv\Scripts\activate
     ```

4. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Запуск

Убедитесь, что виртуальное окружение активировано, затем запустите приложение:
```bash
streamlit run src/main.py
```

Приложение откроется в браузере по адресу `http://localhost:8501`

**Примечание**: Для деактивации виртуального окружения выполните команду `deactivate`

## Использование

1. **Загрузка данных**: Загрузите CSV-файл с температурными данными. Формат файла:
   - `city`: Название города
   - `timestamp`: Дата (формат: YYYY-MM-DD)
   - `temperature`: Среднесуточная температура в °C
   - `season`: Сезон года (winter, spring, summer, autumn)

2. **Анализ данных**: Нажмите кнопку "Запустить анализ данных" для проведения анализа.

3. **Сравнение производительности**: Используйте кнопку "Сравнить производительность распараллеливания" для сравнения последовательного и параллельного анализа.

4. **Мониторинг температуры**: 
   - Введите API ключ OpenWeatherMap
   - Выберите метод запроса (синхронный или асинхронный)
   - Получите текущую температуру и проверьте её на аномальность

## Получение API ключа OpenWeatherMap

1. Зарегистрируйтесь на [OpenWeatherMap](https://openweathermap.org/api)
2. Получите бесплатный API ключ
3. Обратите внимание: ключ может активироваться через 2-3 часа

## Структура проекта

```
Streamlit/
├── src/
│   ├── __init__.py         # Инициализация пакета
│   ├── main.py             # Главный файл Streamlit приложения
│   ├── data_analysis.py    # Функции для анализа данных
│   ├── weather_api.py       # Функции для работы с OpenWeatherMap API
│   └── visualizations.py   # Функции для визуализации данных
├── requirements.txt        # Зависимости проекта
├── .gitignore             # Игнорируемые файлы
└── README.md              # Документация
```

## Особенности реализации

### Распараллеливание анализа данных

- **Последовательный анализ**: Обработка городов по очереди
- **Параллельный анализ (процессы)**: Использует `ProcessPoolExecutor`
- **Параллельный анализ (потоки)**: Использует `ThreadPoolExecutor`

#### Результаты тестирования производительности

**Примечание**: Результаты ниже получены при одном конкретном измерении и могут варьироваться в зависимости от системы, нагрузки, размера данных и других факторов.

При тестировании на датасете с 15 городами и ~54,750 записями (10 лет данных) были получены следующие результаты:

| Метод | Время выполнения | Относительная производительность |
|-------|-------------------|-----------------------------------|
| Последовательно | 0.219 сек | 1.00x (базовый) |
| Параллельно (процессы) | 0.386 сек | 0.57x (медленнее в 1.76x) |
| Параллельно (потоки) | 0.276 сек | 0.79x (медленнее в 1.26x) |

**Выводы на основе данного тестирования:**
- Для небольших и средних датасетов последовательный метод оказался быстрее всех
- Накладные расходы на создание процессов/потоков перевешивают выгоду от распараллеливания
- Распараллеливание эффективно для больших датасетов

### Синхронные и асинхронные запросы к API

- **Синхронный метод**: Использует библиотеку `requests`
- **Асинхронный метод**: Использует библиотеку `aiohttp`

**Выводы**: Для множественных запросов асинхронный метод значительно быстрее, так как позволяет выполнять запросы параллельно.

## Деплой в Streamlit Cloud

TO DO: добавить ссылку на Streamlit Cloud Community
